<!-- Header -->
<div class="sticky top-0 z-10 rounded-md shadow-sm mb-4 bg-white overflow-hidden px-4 pt-2">
  <!-- First Row: Back + Title & Right Actions -->
  <div class="flex flex-wrap items-center justify-between">
    <div class="flex items-center space-x-3">
      <!-- Back Button -->
      <button mat-icon-button class="bg-blue-100 rounded-full p-2 header-back-button" (click)="goBack()">
        <mat-icon>chevron_left</mat-icon>
      </button>
      <!-- Title -->
      <span class="form-header-heading">Order Products Refill Details</span>
    </div>

    <!-- Right Side Buttons -->
    <div class="flex items-center space-x-4 flex items-center space-x-2 ml-auto mt-2 sm:mt-0">

      <!-- Save Button -->
      <button mat-flat-button class="primary-btn-add !text-xs !py-1 !px-4 font-semibold" (click)="submitForm()">
        Save
      </button>

      <button mat-icon-button [matMenuTriggerFor]="actionMenu">
        <mat-icon>arrow_drop_down</mat-icon>
      </button>

      <!-- Menu Items -->
      <mat-menu #actionMenu="matMenu">
        <button mat-menu-item (click)="submitForm(true)">
          <span>Save &amp; Close</span>
        </button>
      </mat-menu>
    </div>
  </div>
</div>

<div class="card-color p-6 rounded-lg shadow-sm border border-gray-200">
  <ng-container>
    <form [formGroup]="orderProductRefillDetailForm">

      <h3 class="text-lg font-medium text-gray-900 mb-6 uppercase tracking-wide">Order Product Refill Details</h3>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
        <!-- Product ID -->
        <div class="space-y-2 custom-text-box">
          <label class="block text-sm font-medium text-gray-700">Product Refill</label>
          <mat-form-field appearance="outline" class="w-full form-input form-input-text">
            <input matInput formControlName="productName" class="text-sm" readonly>
          </mat-form-field>
        </div>

        <div class="space-y-2 custom-text-box">
          <label class="block text-sm font-medium text-gray-700">Days Supply</label>
          <mat-form-field appearance="outline" class="w-full form-input form-input-text">
            <input matInput type="number" formControlName="daysSupply" class="text-sm">
          </mat-form-field>
        </div>

        <div class="space-y-2 custom-text-box">
          <label class="block text-sm font-medium text-gray-700">Dose Amount</label>
          <mat-form-field appearance="outline" class="w-full form-input form-input-text">
            <input matInput type="number" formControlName="doseAmount" class="text-sm">
          </mat-form-field>
        </div>

        <div class="space-y-2 custom-text-box">
          <label class="block text-sm font-medium text-gray-700">Dose Unit</label>
          <mat-form-field appearance="outline" class="w-full form-input form-input-text">
            <input matInput formControlName="doseUnit" class="text-sm">
          </mat-form-field>
        </div>

        <div class="space-y-2 custom-text-box">
          <label class="block text-sm font-medium text-gray-700">Frequency Per Day</label>
          <mat-form-field appearance="outline" class="w-full form-input form-input-text">
            <input matInput formControlName="frequencyPerDay" class="text-sm">
          </mat-form-field>
        </div>

        <div class="space-y-2 custom-text-box">
          <label class="block text-sm font-medium text-gray-700">Bottle Size (ml)</label>
          <mat-form-field appearance="outline" class="w-full form-input form-input-text">
            <input matInput formControlName="bottleSizeMl" class="text-sm">
          </mat-form-field>
        </div>

        <div class="space-y-2 custom-text-box">
          <label class="block text-sm font-medium text-gray-700">Refill Date</label>
          <mat-form-field appearance="outline" class="w-full form-input form-input-text">
            <input matInput [matDatepicker]="picker" formControlName="refillDate">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
        </div>

        <div class="space-y-2 custom-text-box">
          <label class="block text-sm font-medium text-gray-700">Status</label>
          <mat-form-field appearance="outline" class="w-full form-input form-input-text">
            <mat-select formControlName="status">
              <mat-option value="ok">OK</mat-option>
              <mat-option value="skip_supply">Skip Supply</mat-option>
              <mat-option value="unparsable">Unparsable</mat-option>
              <mat-option value="error">Error</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="space-y-2 custom-text-box">
          <label class="block text-sm font-medium text-gray-700">Assumption</label>
          <mat-form-field appearance="outline" class="w-full form-des-input">
            <textarea matInput formControlName="assumption" placeholder="Enter any assumptions..."></textarea>
          </mat-form-field>
        </div>

      </div>
    </form>
  </ng-container>
</div>
