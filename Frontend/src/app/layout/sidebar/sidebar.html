<div class="sidebar-container" [ngClass]="{'collapsed': isCollapsed}">
  <div class="sidebar-header">
    <div class="brand" *ngIf="!isCollapsed">
      <img src="assets/images/logo.png" alt="NewLife HRT" class="brand-logo" />
      <div>
        <p class="brand-title">NewLife HRT</p>
        <p class="brand-subtitle">Management Portal</p>
      </div>
    </div>
    <div class="brand brand-collapsed" *ngIf="isCollapsed">
      <img src="assets/images/logo.png" alt="NewLife HRT" />
    </div>
    <button type="button" class="collapse-toggle" (click)="onToggleSidebar()" aria-label="Toggle sidebar">
      <mat-icon>{{ isCollapsed ? 'chevron_right' : 'chevron_left' }}</mat-icon>
    </button>
  </div>

  <nav class="menu" [ngClass]="{'collapsed': isCollapsed}">
    <ng-container *ngFor="let item of navItems">
      <div class="menu-group" *hasPermission="[item.permissionResource, item.permissionAction]">
        <button type="button" class="menu-item" [ngClass]="{'active': isActiveRoute(item.route || '')}"
          (click)="item.children ? toggleSubmenu(item) : navigateTo(item.route || '')"
          [matTooltip]="isCollapsed ? item.label : ''" matTooltipPosition="right">
          <div class="menu-icon">
            <mat-icon>{{ item.icon }}</mat-icon>
          </div>
          <div class="menu-copy" *ngIf="!isCollapsed">
            <span class="menu-label">{{ item.label }}</span>
            <span class="menu-badge" *ngIf="item.badge">{{ item.badge }}</span>
          </div>
          <mat-icon *ngIf="item.children && !isCollapsed"
            class="submenu-indicator" [ngClass]="{'open': item.isExpanded}">expand_more</mat-icon>
        </button>

        <div *ngIf="item.children && item.isExpanded" class="submenu" [ngClass]="{'floating': isCollapsed}">
          <button type="button" class="submenu-item" *ngFor="let child of item.children"
            [ngClass]="{'active': isActiveRoute(child.route || '')}"
            (click)="navigateTo(child.route || '')">
            <mat-icon class="submenu-icon">{{ child.icon }}</mat-icon>
            <span>{{ child.label }}</span>
          </button>
        </div>
      </div>
    </ng-container>
  </nav>

  <div class="sidebar-footer" *ngIf="userAccount as account">
    <div class="user-pill">
      <div class="avatar">{{ userInitials }}</div>
      <div class="user-copy" *ngIf="!isCollapsed">
        <p class="name">{{ account.fullname }}</p>
        <span class="role">{{ account.role }}</span>
      </div>
    </div>

    <button type="button" class="logout-btn" (click)="navigateTo('/logout')">
      <mat-icon>logout</mat-icon>
      <span *ngIf="!isCollapsed">Logout</span>
    </button>
  </div>
</div>
